# Case 001 – Investigation Procedure and Findings (PCAP)

**Case ID:** 001-macro-malware-data-exfiltration  
**Time Standard:** UTC  
**Source Platform:** CyberDefenders CyberRange  

## Summary of Key Findings (Confirmed)

- **Victim host:** `10.2.7.101`
- **Malware delivery domain:** `microflash.no`
- **Malware download URL:** `http://microflash.no/includes/AL5THvvehvvvajyc.exe`
- **Malware delivery IP:** `205.186.187.108:80`
- **Malware SHA-256:** `72505cc347af0524c7f22ca97cb2547b7d51a1764ec43d1de7679c1072622c11`
- **Exfiltration server IP:** `89.46.222.42`
- **Exfiltration protocol:** FTP (control on port **21**, data over high ports)
- **FTP credentials observed:** `admin_szafhhjjk:<redacted>`  
- **Exfil session duration (Wireshark Conversations):** `01:40:53`
- **Gmail password recovered in exfiltrated HTML:** `P@ssw0rd$`
- **Most frequent Suricata alert signature:** `ET INFO DNS Query for Suspicious .ga Domain`

## Step 1 – NetFlow Overview (nfpcapd/nfdump)

### Commands Used
```bash
nfpcapd -r malicious.pcap -w ~/netflow_data
nfdump -R /path/to/netflow_data
nfdump -R ../../nfcapd/ -s record/bytes -n 10
```
### Key Observation

Top byte-volume flows highlight two main relationships:
- 205.186.187.108:80 ↔ 10.2.7.101:49158 (malware delivery over HTTP)
- 10.2.7.101:* ↔ 89.46.222.42:12xxx (repeated outbound sessions consistent with exfil/C2)

## Step 2 – Identify Malware Download Source (DNS + HTTP)
### Q1 – Malware Download Domain

**Answer**: microflash.no (source)

### Evidence

Zeek HTTP log shows:
- Host: microflash.no
- URI: /includes/AL5THvvehvvvajyc.exe
- Method: GET
- Response MIME: application/x-dosexec
- Response size: 906,920 bytes
- Status: 200 OK

## Step 3 – Validate Malware Download via IDS Alert

**Suricata alert observed**:

- Signature: ET POLICY PE EXE or DLL Windows file download HTTP
- src: 205.186.187.108:80
- dest: 10.2.7.101:49158
- app_proto: http

**Assessment**: Indicates unencrypted HTTP download of a Windows PE file.

## Step 4 – Extract Malware + Hash
### Q2 – Malware SHA-256

**Answer**:
SHA-256: `72505cc347af0524c7f22ca97cb2547b7d51a1764ec43d1de7679c1072622c11`

### Evidence / Command
`sha256sum /opt/NetworkMiner/AssembledFiles/205.186.187.108/TCP-80/includes/AL5THvvehvvvajyc.exe`

## Step 5 – Threat Intel Enrichment

VirusTotal analysis for malware hash indicates infostealer behavior and contacted infrastructure consistent with observed PCAP activity.

### Q3 – VBS Script Associated with Malware

**Answer**: catsin.vbs

**Referenced VT entry**:

SHA-256: `4c34199eabf6cb6a7c6b5a3c025cc6d02f65f964fa94147c616bf96ee4e0ae34`

## Step 6 – Identify Victim + Exfil Destination
### Q4 – Victim IP

**Answer**: 10.2.7.101

### Q5 – Exfil Server IP

**Answer**: 89.46.222.42

**Evidence**: NetworkMiner “Files” tab shows multiple FTP STOR transfers from victim to 89.46.222.42.

## Step 7 – Exfil Port and FTP Credentials
### Q6 – Exfil Port Used for Credential File

**Answer**: 21 (FTP control channel)

### Q7 – FTP Username/Password

**Answer**: admin_szafhhjjk:<redacted>

Note: Password is present in PCAP-derived artifacts and should be treated as sensitive even in a lab context. Consider redacting in public repos.

## Step 8 – Exfil Duration
### Q8 – Session Duration

**Answer**: 01:40:53

**Evidence**: Wireshark Conversations (IPv4) between 10.2.7.101 and 89.46.222.42 showed duration 6053.79s (~1:40:53).

## Step 9 – Harvested Gmail Credential
### Q9 – Gmail Password

**Answer**: P@ssw0rd$

**Evidence**: Exfiltrated HTML (Recovery_anthony...html) contains credential entries for:

- smtp.gmail.com (Outlook)
- bbt.com (InternetExplorer)
Both showing Password: P@ssw0rd$

## Step 10 – Most Frequent Alert Signature
### Q10 – Most Frequent Alert

**Answer**: ET INFO DNS Query for Suspicious .ga Domain

**Evidence**: Zui alert aggregation:
`event_type=="alert" | count() by alert.signature`

**Highest count**: .ga DNS query signature (count: 6).

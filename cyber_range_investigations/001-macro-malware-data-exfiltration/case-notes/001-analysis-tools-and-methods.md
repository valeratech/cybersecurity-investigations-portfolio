# Case 001 – Macro Malware Data Exfiltration
## Analysis Notes – Tools, Methods, and Workflow

### Overview
This document captures the tools, commands, and methodologies used in the network forensics investigation.  
Scenario source: **CyberDefenders CyberRange**.

The investigation focuses on PCAP-based analysis to reconstruct the malicious macro execution, malware download, command-and-control activity, and outbound data exfiltration.

## 1. Tools & Applications Used

### Network / Packet / Flow Analysis

**nfpcapd**  
- Converts PCAP into NetFlow format for flow-based aggregation.  
- Used for identifying top talkers, byte volume, and suspicious external traffic.

**nfdump**  
- Analyzes NetFlow records generated by nfpcapd.  
- Primary use: flow sorting, traffic summaries, directionality, and outlier detection.

**Zui**  
- GUI interface for Zeek logs.  
- Useful for pivoting through DNS, HTTP, FTP, and connection logs.

**Suricata**  
- IDS engine generating event_type: "alert" logs.  
- Used to validate detections related to EXE file downloads, suspicious domain usage, and external IP checks.

**Zeek**  
- Network metadata collection: DNS, HTTP, connection, files, SMB, etc.  
- Used to reconstruct attacker activity from protocol behaviors rather than raw packets.

**Wireshark**  
- Deep packet inspection and filtering.  
- Used to verify payloads, file transfers, HTTP requests, DNS responses, and suspicious communications.

**NetworkMiner**  
- PCAP artifact extraction tool.  
- Used to reconstruct downloaded binaries, credentials, and additional files.

## 2. Online Analysis / Threat Intel

**VirusTotal**  
- Used to analyze malware samples (`catsin.vbs` hash) and downloaded EXEs.  
- Assists in validating whether the recovered file is known malware.

**checkip.amazonaws.com** (External IP lookup domain)  
- Observed in both Zeek and Suricata alerts.  
- Often used during malware beaconing or exfil validation.

**Financial / Credential HTTPS sites**  
- bbt.com (Online banking portal)  
- smtp.gmail.com (Potential email-based credential exfil attempt)

## 3. CLI Commands & Queries Used

### NetFlow Generation & Analysis
```bash
nfpcapd -r malicious.pcap -w ~/netflow_data
nfdump -R /path/to/netflow_data
nfdump -R ../../nfcapd/ -s record/bytes -n 10
```
## 4. Time Handling (Standardization Decision)

All timestamps used in this investigation will be interpreted and documented in **UTC** unless the CyberDefenders CyberRange explicitly specifies another timezone.

### Reasoning / Analyst Notes
- The PCAP, Zeek logs, Suricata alerts, and NetFlow timestamps must correlate without drift.  
- Using UTC prevents ambiguity during timeline reconstruction and avoids discrepancies when comparing tool outputs.  
- This aligns with DFIR best practice for investigations involving multi-source log analysis.

If future CyberRange documentation reveals a scenario-specific timezone, I will re-normalize all timestamps and update both the notes and metadata accordingly.


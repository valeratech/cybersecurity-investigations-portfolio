# Evidence Metadata – Tools & Usage Documentation  
Case: 001 – Macro Malware Data Exfiltration  
Source: CyberDefenders CyberRange  

## 1. Purpose of This Document
This file documents all tools, frameworks, and external intelligence sources used during the examination of evidence for Case 001.  
It ensures **chain-of-custody transparency**, supports **reproducibility**, and defines **expected outputs** from every analytical tool involved in the investigation.

## 2. Tool Categories, Purposes, and Expected Outputs

## A. Network Forensics & Packet Analysis Tools

### **1. Wireshark**
**Purpose:**  
- Deep packet inspection  
- Extract HTTP requests/responses  
- Inspect DNS queries, TCP streams, and exfil indicators  

**Tool Type:** Packet analysis GUI

**Expected Output:**  
- Manual findings, screenshots, filtered packet captures  
- Exported objects (HTML, EXE files, PCAP subsets)

### **2. NetworkMiner**
**Purpose:**  
- Artifact reconstruction from PCAP (files, credentials, sessions)  
- Extract malware payloads and artifacts downloaded via HTTP  

**Tool Type:** Packet reconstruction / passive forensic analysis

**Expected Output:**  
- Extracted file artifacts (EXE, VBS, HTML)  
- Recovered credentials and host metadata  
- Session summaries

## B. Flow Analysis Tools

### **3. nfpcapd**
**Purpose:**  
- Convert raw PCAP into NetFlow format for large-scale traffic aggregation  

**Tool Type:** Flow generator

**Expected Output:**  
- Flow files in **nfcapd** format  
  Example:  
  `nfcapd.202501010015`

### **4. nfdump**
**Purpose:**  
- Analyze NetFlow to identify top talkers, byte counts, suspicious flows  
- Detect exfiltration patterns (large outbound flows, uncommon external IPs)  

**Tool Type:** Flow analysis CLI tool

**Expected Output:**  
- Text-based flow summaries  
- CSV exports (optional)  
- Commands used:  
  - `-s record/bytes` sorting  
  - `-n <count>` limiting top flow results  

## C. IDS / NSM Analysis Tools

### **5. Suricata**
**Purpose:**  
- Generate IDS alerts from PCAP  
- Detect EXE downloads, suspicious DNS queries (.ga domains), external IP checks  

**Tool Type:** Intrusion Detection System (IDS) / Network Security Monitoring

**Expected Output:**  
- **eve.json** logs containing:  
  - `event_type: "alert"`  
  - Signatures from Emerging Threats (ET) ruleset  
  - HTTP/S detection events  
  - DNS alerts  

Examples:  
- *ET POLICY PE EXE or DLL Download*  
- *ET INFO DNS Query for Suspicious .ga Domain*

### **6. Zeek**
**Purpose:**  
- Produce rich metadata logs for DNS, HTTP, connection-level events  
- Identify malware download chains & C2 behavior  

**Tool Type:** Network Security Monitoring (NSM) framework

**Expected Output Files (TSV format):**  
- `dns.log`  
- `http.log`  
- `conn.log`  
- `files.log`  
- `ssl.log` (if applicable)

These logs are later visualized in **Zui**.

## D. Log Visualization & Pivoting Tools

### **7. Zui**
**Purpose:**  
- GUI-based analysis of Zeek and Suricata logs  
- Pivot across logs to identify related events  
- Run queries (similar to Splunk/Elastic)  

**Tool Type:** Log analysis GUI

**Expected Output:**  
- Analyst-generated queries  
- Exported result sets (JSON, CSV)  
- Pivot tables linking DNS → HTTP → Suricata alerts  

Sample queries:  
- DNS pivot: `_path=="dns" and "205.186.187.108" in answers`  
- Alert counts: `event_type=="alert" | count() by alert.signature`

## E. Threat Intelligence Tools & Services

### **8. VirusTotal**
**Purpose:**  
- Validate malware samples recovered from packets  
- Check EXE hash reputation  
- Retrieve detection names and sandbox behavior  

**Tool Type:** Cloud malware analysis platform

**Expected Output:**  
- Malware classification  
- Sandbox behavioral indicators  
- Hash-based reputation scoring  

Referenced sample:  
`catsin.vbs`  
https://www.virustotal.com/gui/file/4c34199eabf6cb6a7c6b5a3c025cc6d02f65f964fa94147c616bf96ee4e0ae34/detection

### **9. Open Web Indicators**
**Purpose:**  
Provide attacker infrastructure context.

**Observed & Referenced Domains:**

| Domain | Purpose | Notes |
|--------|---------|-------|
| **microflash.no** | Malware hosting | Delivered malicious EXE |
| **working-from-home.ga** | C2 / Exfiltration | Resolves to 89.46.222.42 |
| **checkip.amazonaws.com** | IP lookup | Often abused by malware |
| **bbt.com** | Financial target domain | Victim interest or exfil target |
| **smtp.gmail.com** | Email exfil channel | Potential credential use |

## 3. Hashing Tools & Commands

### File Integrity Verification
Used to fingerprint extracted malware samples.

Command:
```bash
sha256sum /opt/NetworkMiner/AssembledFiles/205.186.187.108/TCP-80/includes/AL5THvvehvvvajyc.exe

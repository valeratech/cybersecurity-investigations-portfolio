# 001 – Macro Malware Data Exfiltration (Network Investigation)

**Case Title:** Macro Malware Data Exfiltration – Network Forensics  
**Case ID:** 001-macro-malware-data-exfiltration  
**Date Created:** 12-09-2025   
**Last Updated:** 12-09-2025  
**Author:** Ryan Valera

## 1. Overview

### Objective

Analyze captured network traffic (PCAP) to:

- Confirm that a malicious macro executed and downloaded malware.
- Reconstruct the sequence of events leading to unauthorized data exfiltration.
- Identify key indicators of compromise (IOCs) and notable attacker behaviors observable in network traffic.

### Scenario Summary

A malicious macro embedded in a document triggered a malware download, which ultimately led to the unauthorized exfiltration of sensitive data from a targeted machine. After the breach was detected, network traffic was captured and preserved in a PCAP file.

This investigation focuses solely on analyzing the network capture to reconstruct the attack chain and identify evidence of data exfiltration.

- **Source Platform:** CyberDefenders CyberRange  
- **Investigation Type:** Network Forensics (PCAP Analysis)  

### Key Questions

- What network indicators show the malicious macro downloading malware?
- Which hosts (IP/ports) participated in command-and-control or data exfiltration?
- What protocols and channels were used for exfiltration (HTTP(S), DNS, other)?
- What IOCs (domains, IPs, URIs, hashes if extractable) can be derived from the PCAP?

## 2. Scope of This Repository

This case directory is dedicated to **network forensics** for the macro-malware data exfiltration scenario.

Structure:

- `case-notes/` – Analyst notes, observations, rough timelines.  
- `evidence-metadata/` – Hashes, acquisition details, and chain-of-custody for PCAPs and related files.  
- `pcaps/` – Original PCAP(s) Unavailable (Remote VM Test Environment).  
- `analysis/` – Wireshark profiles, filters, Zeek configs/logs, timelines, and pivot points.  
- `scripts/` – Helper scripts (Python, Bash, Zeek, etc.) used during analysis.  
- `reports/` – Final and interim reports derived from this investigation.

## 3. Current Evidence

### PCAPs

- **File Name:** `final.pcap`  
- **Location:** `/home/ubuntu/Desktop/Start here/Artifacts//final.pcap`  
- **Source:** CyberDefenders CyberRange  
- **Description:** Network traffic captured after detection of a macro-triggered malware infection resulting in data exfiltration.

(Hashes, acquisition timestamps, and integrity details will be documented in `evidence-metadata/`.)

## 4. Planned Analysis Approach (High-Level)

1. Establish an overview of network activity (top talkers, protocols, and ports).  
2. Identify the malware download sequence associated with the malicious macro.  
3. Pivot on suspicious endpoints, URIs, and protocols to trace command-and-control or staging activity.  
4. Isolate and characterize data exfiltration flows (volume, destination, method).  
5. Extract IOCs and map observed behaviors to MITRE ATT&CK techniques.

As analysis progresses, detailed findings will be captured in:

- `case-notes/` for step-by-step reasoning.  
- `reports/001-macro-malware-data-exfiltration_Report.md` for the final narrative.

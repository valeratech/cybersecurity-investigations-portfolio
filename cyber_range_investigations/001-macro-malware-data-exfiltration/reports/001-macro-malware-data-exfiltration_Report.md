# Investigation Report – Case 001: Macro Malware Data Exfiltration

**Case Title:** Macro Malware Data Exfiltration – Network Forensics  
**Case ID:** 001-macro-malware-data-exfiltration  
**Date Created:** 12-09-2025  
**Last Updated:** 12-12-2025  
**Author:** Ryan Valera  
**Time Standard:** UTC  
**Source Platform:** CyberDefenders CyberRange  


## 1. Overview

### Objective
Analyze a PCAP to reconstruct a macro-triggered malware infection resulting in data exfiltration, extract IOCs, and document a defensible event timeline.

### Scenario Summary
A malicious macro led to the download of a Windows executable over HTTP. Post-infection traffic shows outbound FTP-based data exfiltration to an external host.


## 2. Evidence Collected

`final.pcap` (CyberDefenders CyberRange)

## 3. Key Findings (Confirmed)

- Victim host: `10.2.7.101`
- Malware delivery:
  - Domain: `microflash.no`
  - IP: `205.186.187.108:80`
  - URL: `http://microflash.no/includes/AL5THvvehvvvajyc.exe`
  - SHA-256: `72505cc347af0524c7f22ca97cb2547b7d51a1764ec43d1de7679c1072622c11`
- Exfiltration:
  - Destination IP: `89.46.222.42`
  - Protocol: FTP (control: 21/tcp; data: high ports)
  - Exfil duration: `01:40:53`
  - FTP credentials observed: `admin_szafhhjjk:<redacted>`
  - Exfil artifacts include screenshots and a credential recovery HTML file
- Most frequent alert: `ET INFO DNS Query for Suspicious .ga Domain`


## 4. Timeline Reconstruction (UTC)
See: `analysis/003-timeline-utc.md`


## 5. Network Analysis

### 5.1 Malware Download
Zeek HTTP logs and Wireshark confirm an HTTP GET request to `microflash.no` retrieving a PE executable (~907 KB).

### 5.2 Exfiltration
NetworkMiner and Zeek FTP logs confirm multiple `STOR` transfers from victim to `89.46.222.42`, including screenshot JPEGs and a credential recovery HTML.


## 6. Indicators of Compromise
See: `analysis/002-network-ioCs.md`


## 7. MITRE ATT&CK Mapping (Observed / Supported)
- T1204 User Execution (macro-based user execution)
- T1105 Ingress Tool Transfer (HTTP download of PE)
- T1071.001 Application Layer Protocol: Web (HTTP)
- T1041 Exfiltration Over C2 Channel (exfil to external host)
- T1071.002 Application Layer Protocol: File Transfer Protocols (FTP)


## 8. Recommendations (Defensive)
- Block outbound FTP (21/tcp) at perimeter unless explicitly required
- Add DNS monitoring for suspicious/abused TLDs (e.g., `.ga`)
- Enforce email attachment controls and macro restrictions
- Inspect outbound HTTP downloads for PE MIME types (`application/x-dosexec`)
- Implement egress filtering and alerting on large outbound transfers to untrusted hosts

# Case 003 â€” Webshell Upload & HTTP Exploitation

**Case ID:** 003  
**Author:** Ryan Valera  
**Time Standard:** UTC  
**Source Platform:** CyberDefenders CyberRange  

## Purpose
This document confirms the initial compromise of the HR web server by identifying a successful unrestricted file upload that resulted in a malicious webshell being deployed. The analysis correlates IDS alerts, Zeek file metadata, and raw HTTP traffic to prove exploitation.

## Data Sources
- PCAP (E-001)
- Suricata IDS alerts
- Zeek `files.log`
- Wireshark HTTP stream inspection

All timestamps referenced below are treated as **UTC**.

## Exploitation Indicator

### IDS Alert
- **Signature:** `ET WEB_SERVER WebShell Generic - ASP File Uploaded`
- **Category:** Network Trojan Detected
- **Source IP:** `3.68.76.39`
- **Destination IP:** `10.10.3.115`
- **Destination Port:** `80/TCP`
- **Timestamp:** 2025-05-20 18:28:03Z

This alert indicates a high-confidence detection of a webshell upload targeting an ASP-based web application.

## HTTP Upload Analysis

### Request Details
- **Method:** POST
- **URI:** `/profile.aspx`
- **Host:** `hr.compliantsecure.store`
- **Content-Type:** `multipart/form-data`
- **User-Agent:** Chrome (Linux x86_64)

The request body contained a file upload consistent with a job application submission, which was used to bypass input validation controls.

## Extracted File Metadata (Zeek)

Zeek `files.log` provided authoritative metadata confirming the uploaded file:

- **Filename:** `mycv.aspx`
- **MIME Type:** `text/plain`
- **Source IP:** `3.68.76.39`
- **Destination IP:** `10.10.3.115`
- **Transfer Timestamp:** 2025-05-20 18:28:03Z
- **MD5:** `2be86b49e21ebbbc1507ee5ac97f47e4`
- **SHA1:** `21cfe9efa65fd2a09aaf21cf633fb4160db1f62a`
- **Observed Size:** ~20 KB

The `.aspx` extension confirms the file is executable within the IIS/ASP.NET environment.

## Validation via Packet Inspection

Wireshark stream reconstruction confirmed:
- The file was transferred in full
- No server-side validation blocked execution
- The upload endpoint accepted and processed the file successfully

This establishes that the attacker achieved **remote code execution** through the webshell.

## Analytical Assessment

Based on:
- A dedicated webshell upload alert
- Zeek-confirmed executable file transfer
- Packet-level confirmation of a successful POST request

The upload of `mycv.aspx` is assessed as the **initial access vector** used by the attacker to compromise the HR web server.

This marks the transition from reconnaissance to **active exploitation**.

## Impact on Investigation Flow

Successful webshell deployment enabled the attacker to:
- Execute arbitrary commands on the server
- Enumerate the environment and domain
- Download and execute additional tooling
- Pivot into the internal network

Subsequent analysis focuses on **post-exploitation behavior** performed through the webshell.

## Next Investigative Pivot

Following confirmation of exploitation:
- Analyze HTTP requests interacting with the webshell
- Identify authentication mechanisms used by the shell
- Extract command execution activity
